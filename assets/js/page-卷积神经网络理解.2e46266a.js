(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{501:function(t,s,a){t.exports=a.p+"assets/img/architecture-1.8b2570f0.png"},502:function(t,s,a){t.exports=a.p+"assets/img/architecture-2.61bbeb55.png"},503:function(t,s,a){t.exports=a.p+"assets/img/特征提取.6428cf50.gif"},504:function(t,s,a){t.exports=a.p+"assets/img/卷积.517aad1b.png"},505:function(t,s,a){t.exports=a.p+"assets/img/滤波器.46870a45.jpg"},506:function(t,s,a){t.exports=a.p+"assets/img/卷积计算.26e260a2.png"},507:function(t,s,a){t.exports=a.p+"assets/img/可视化过程.ae8a4d6f.gif"},508:function(t,s,a){t.exports=a.p+"assets/img/多通道卷积.ac7f6f97.png"},509:function(t,s,a){t.exports=a.p+"assets/img/池化层.15e89ec6.gif"},510:function(t,s,a){t.exports=a.p+"assets/img/pooling_type.1d4222f8.png"},511:function(t,s,a){t.exports=a.p+"assets/img/手写数字识别.71d2cd56.png"},512:function(t,s,a){t.exports=a.p+"assets/img/fc.0fbcd838.png"},513:function(t,s,a){t.exports=a.p+"assets/img/全连接层.17ece85b.png"},514:function(t,s,a){t.exports=a.p+"assets/img/fc-1.7b40efdf.jpg"},515:function(t,s,a){t.exports=a.p+"assets/img/fc-2.6c595937.jpg"},516:function(t,s,a){t.exports=a.p+"assets/img/result.a7747dd6.jpg"},517:function(t,s,a){t.exports=a.p+"assets/img/梯度下降.6ed1a421.png"},682:function(t,s,a){"use strict";a.r(s);var i=a(1),e=Object(i.a)({},(function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[i("h2",{attrs:{id:"发展历程"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#发展历程"}},[t._v("#")]),t._v(" 发展历程")]),t._v(" "),i("p",[t._v("1998年 Yann LeCun教授在论文Gradient-Based Learning Applied to Document Recognition中提出了LeNet-5，将Backpropagation算法应用到神经网络结构训练中，形成了卷积神经网络（CNN）的雏形。")]),t._v(" "),i("p",[t._v("2012年，在ImageNet图像识别大赛中，Hinton组的论文ImageNet Classification with Deep Convolutional Neural Networks中提到了AlexNet，引入了全新的深层结构和Dropout正则化方法，CNN开始蓬勃发展。")]),t._v(" "),i("h2",{attrs:{id:"基本概念"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#基本概念"}},[t._v("#")]),t._v(" 基本概念")]),t._v(" "),i("p",[t._v("卷积核（滤波器）：filter。如3×3、5×5之类的。")]),t._v(" "),i("p",[t._v("特征图：feature map。输入和卷积核对应相乘累加计算得到的结果所组成，"),i("strong",[t._v("一个卷积核对应一个feature map")]),t._v("。")]),t._v(" "),i("p",[t._v("卷积层：Convolutional layer。用于提取底层特征")]),t._v(" "),i("p",[t._v("池化层：pooling layer。防止过拟合，并降维")]),t._v(" "),i("p",[t._v("全连接层：fully-connected layer。汇总前面卷积层和池化层后特征，并输出结果，输出包括：softmax（各个分类的归一化概率分布）、sigmoid（二分类）")]),t._v(" "),i("h2",{attrs:{id:"基本结构"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#基本结构"}},[t._v("#")]),t._v(" 基本结构")]),t._v(" "),i("p",[t._v("大体上的基本结构主要包括：卷积层、池化层、全连接层")]),t._v(" "),i("center",[i("img",{attrs:{src:a(501),width:"90%"}})]),t._v(" "),i("center",[i("img",{attrs:{src:a(502),width:"90%"}})]),t._v(" "),i("h2",{attrs:{id:"卷积计算"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#卷积计算"}},[t._v("#")]),t._v(" 卷积计算")]),t._v(" "),i("center",[i("img",{attrs:{src:a(503),width:"50%"}})]),t._v(" "),i("p",[t._v("左边动的红色部分是一个不变的3×3的kernel，卷积核。滑动过程中，卷积核对应位置和Image对应位置进行乘积，并求和，得到右边输出结果。")]),t._v(" "),i("center",[i("img",{attrs:{src:a(504),width:"50%"}})]),t._v(" "),i("p",[t._v("卷积核光顾到的地方称为"),i("strong",[t._v("感受野")]),t._v("（Receptive Field）。")]),t._v(" "),i("div",{staticClass:"custom-block tip"},[i("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),i("p",[t._v("感受野（Receptive Field）：CNN每一层输出的特征图（feature map）上的像素点映射回输入图像上的区域大小。即特征图上一点相对于原图的大小，是CNN特征所能看到输入图像的区域。")]),t._v(" "),i("p",[t._v("感受野作用：")]),t._v(" "),i("p",[t._v("（1）小尺寸的卷积核代替大尺寸的卷积核，可以减少网络参数、增加网络深度、扩大感受野（如3个3×3的卷积核的叠加可以代替7×7的卷积核），网络深度越深，感受野性能越好。")]),t._v(" "),i("p",[t._v("（2）对于分类任务，最后一层feature map感受野大小要≥输入图像大小，否则分类性能不理想。")]),t._v(" "),i("p",[t._v("（3）对于目标检测任务，若感受野小，而目标尺寸大；或感受野大，目标尺寸小，模型收敛困难。")])]),t._v(" "),i("p",[t._v("上图中，左边是原始输入数据，中间是卷积核，右边是输出的新的二维数据，称为"),i("strong",[t._v("特征图")]),t._v("（feature map），")]),t._v(" "),i("center",[i("img",{attrs:{src:a(505),width:"50%"}})]),t._v(" "),i("p",[t._v("在CNN中，filter（带一组固定权重的神经元）对局部输入数据进行卷积计算，每计算完一个数据窗口内的局部数据后，数据窗口不断平滑移动，直到计算完所有数据，过程中有如下几个参数：")]),t._v(" "),i("div",{staticClass:"custom-block tip"},[i("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),i("p",[t._v("①深度depth：神经元个数，决定输出的depth厚度，也代表滤波器filter个数，也是生成的feature map的个数")]),t._v(" "),i("p",[t._v("②步长stride：决定滑动多少步到边缘。【"),i("strong",[t._v("有时候需要stride来压缩一部分信息")]),t._v("】")]),t._v(" "),i("p",[t._v("③填充padding：在外围边缘补充若干圈0，方便从初始位置以步长为单位可以刚好滑到末尾位置，即为了总长能被步长整除。使用padding是为了防止边缘特征被忽略。【"),i("strong",[t._v("有时候需要padding来避免信息损失")]),t._v("】")]),t._v(" "),i("p",[i("strong",[t._v("常用的两种padding方式：")])]),t._v(" "),i("ul",[i("li",[i("strong",[t._v("valid padding")]),t._v("：不进行处理，只使用原始尺寸，并且不允许卷积核超出原始尺寸边界。")]),t._v(" "),i("li",[i("strong",[t._v("same padding")]),t._v("：进行填充处理，允许卷积核超出原始尺寸边界，并且使得卷积后结果的尺寸和原始输入尺寸一致。")])])]),t._v(" "),i("p",[i("strong",[t._v("卷积计算")]),t._v("：卷积核和在输入图像上对应滑动到的位置的像素相乘，并求和。")]),t._v(" "),i("center",[i("img",{attrs:{src:a(506),width:"50%"}})]),t._v(" "),i("p",[t._v("假设输入图片的尺寸："),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("n")]),i("mo",[t._v("×")]),i("mi",[t._v("n")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("n \\times n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.6667em","vertical-align":"-0.0833em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("n")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),i("span",{staticClass:"mbin"},[t._v("×")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.4306em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("n")])])])])]),t._v(" "),i("p",[t._v("卷积核大小："),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("f")]),i("mo",[t._v("×")]),i("mi",[t._v("f")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("f \\times f")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.8889em","vertical-align":"-0.1944em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10764em"}},[t._v("f")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),i("span",{staticClass:"mbin"},[t._v("×")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.8889em","vertical-align":"-0.1944em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10764em"}},[t._v("f")])])])])]),t._v(" "),i("p",[t._v("填充padding大小："),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("p")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("p")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.625em","vertical-align":"-0.1944em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("p")])])])])]),t._v(" "),i("p",[t._v("步长stride大小："),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("s")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("s")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.4306em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("s")])])])])]),t._v(" "),i("p",[t._v("输出图片的尺寸："),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("o")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("o")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.4306em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("o")])])])])]),t._v(" "),i("p",[t._v("则输出尺寸的计算公式为：")]),t._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mtable",{attrs:{rowspacing:"0.16em",columnspacing:"1em"}},[i("mtr",[i("mtd",{staticClass:"mtr-glue"}),i("mtd",[i("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[i("mrow",[i("mi",[t._v("o")]),i("mo",[t._v("=")]),i("mo",{attrs:{stretchy:"false"}},[t._v("⌊")]),i("mfrac",[i("mrow",[i("mi",[t._v("n")]),i("mo",[t._v("+")]),i("mn",[t._v("2")]),i("mi",[t._v("p")]),i("mo",[t._v("−")]),i("mi",[t._v("f")])],1),i("mi",[t._v("s")])],1),i("mo",{attrs:{stretchy:"false"}},[t._v("⌋")]),i("mo",[t._v("+")]),i("mn",[t._v("1")])],1)],1)],1),i("mtd",{staticClass:"mtr-glue"}),i("mtd",{staticClass:"mml-eqn-num"})],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\begin{equation}\no = \\lfloor \\frac{n+2p-f}{s} \\rfloor +1\n\\end{equation}\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.0574em","vertical-align":"-0.7787em"}}),i("span",{staticClass:"mtable"},[i("span",{staticClass:"col-align-c"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.2787em"}},[i("span",{staticStyle:{top:"-3.2787em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3.3714em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathnormal"},[t._v("o")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),i("span",{staticClass:"mopen"},[t._v("⌊")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.3714em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathnormal"},[t._v("s")])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathnormal"},[t._v("n")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),i("span",{staticClass:"mbin"},[t._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),i("span",{staticClass:"mord"},[t._v("2")]),i("span",{staticClass:"mord mathnormal"},[t._v("p")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),i("span",{staticClass:"mbin"},[t._v("−")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10764em"}},[t._v("f")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mclose"},[t._v("⌋")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),i("span",{staticClass:"mbin"},[t._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),i("span",{staticClass:"mord"},[t._v("1")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.7787em"}},[i("span")])])])])])]),i("span",{staticClass:"tag"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.2787em"}},[i("span",{staticStyle:{top:"-3.2787em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3.3714em"}}),i("span",{staticClass:"eqn-num"})])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.7787em"}},[i("span")])])])])])])])]),t._v(" "),i("p",[t._v("其中，"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("⌊")]),i("mo",{attrs:{stretchy:"false"}},[t._v("⌋")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\lfloor \\rfloor")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mopen"},[t._v("⌊")]),i("span",{staticClass:"mclose"},[t._v("⌋")])])])]),t._v("表示向下取整，用于结果不是整数时进行向下取整。")]),t._v(" "),i("h2",{attrs:{id:"卷积的可视化"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#卷积的可视化"}},[t._v("#")]),t._v(" 卷积的可视化")]),t._v(" "),i("blockquote",[i("p",[t._v("一个可视化网站：convolution visualizer：https://ezyang.github.io/convolution-visualizer/index.html")])]),t._v(" "),i("h2",{attrs:{id:"多通道卷积"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#多通道卷积"}},[t._v("#")]),t._v(" 多通道卷积")]),t._v(" "),i("p",[t._v("一个可视化例子：https://thomelane.github.io/convolutions/2DConvRGB.html")]),t._v(" "),i("p",[t._v("卷积核红绿蓝部分，分别和输入的红绿蓝层进行做卷积计算，该“三阶魔方”所有结果相加，得到最后的输出。")]),t._v(" "),i("p",[t._v("该部分具体讲解参见：https://www.bilibili.com/video/BV1AJ411Q72b?p=3&spm_id_from=pageDriver")]),t._v(" "),i("center",[i("img",{attrs:{src:a(507),width:"80%"}})]),t._v(" "),i("ul",[i("li",[t._v("左边7×7×3代表图像像素的长宽 ，3是RGB三个颜色通道")]),t._v(" "),i("li",[t._v("中间部分是两个不同的滤波器，是3×3×3的卷积核")]),t._v(" "),i("li",[t._v("两个神经元，depth=2，有两个滤波器")]),t._v(" "),i("li",[t._v("数据窗口每次移动2个步长取3×3的局部数据，stride=2")]),t._v(" "),i("li",[t._v("zero-padding=1")]),t._v(" "),i("li",[t._v("还有个偏置项bias，往往是一个标量，直接相加")])]),t._v(" "),i("p",[t._v("分别以两个滤波器filter为轴滑动数组进行卷积计算，得到两组不同的结果。")]),t._v(" "),i("p",[t._v("假设stride=1，padding=0，如下图所示：卷积是在提取输入的底层特征。")]),t._v(" "),i("center",[i("img",{attrs:{src:a(508),width:"80%"}})]),t._v(" "),i("p",[t._v("上图中，"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mn",[t._v("3")]),i("mo",[t._v("∗")]),i("mn",[t._v("3")]),i("mo",[t._v("∗")]),i("mn",[t._v("3")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("3*3*3")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.6444em"}}),i("span",{staticClass:"mord"},[t._v("3")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),i("span",{staticClass:"mbin"},[t._v("∗")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.6444em"}}),i("span",{staticClass:"mord"},[t._v("3")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),i("span",{staticClass:"mbin"},[t._v("∗")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.6444em"}}),i("span",{staticClass:"mord"},[t._v("3")])])])]),t._v("的卷积核和3通道的输入，对应维度进行卷积运算，最后再将三个维度的对应值相加，最后得到一个"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mn",[t._v("4")]),i("mo",[t._v("∗")]),i("mn",[t._v("4")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("4*4")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.6444em"}}),i("span",{staticClass:"mord"},[t._v("4")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),i("span",{staticClass:"mbin"},[t._v("∗")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.6444em"}}),i("span",{staticClass:"mord"},[t._v("4")])])])]),t._v("的矩阵，加上偏置项，可以得到一个最终的单通道的输出。")]),t._v(" "),i("p",[t._v("若存在多个卷积核，把每一个卷积核对应的单通道输出组合成一个总的输出。")]),t._v(" "),i("p",[i("strong",[t._v("filter的通道数和输出的feature map的通道数")])]),t._v(" "),i("ul",[i("li",[i("strong",[t._v("某一层滤波器的通道数=上一层feature map的通道数")]),t._v("，如上图"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mn",[t._v("6")]),i("mo",[t._v("∗")]),i("mn",[t._v("6")]),i("mo",[t._v("∗")]),i("mn",[t._v("3")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("6*6*3")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.6444em"}}),i("span",{staticClass:"mord"},[t._v("6")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),i("span",{staticClass:"mbin"},[t._v("∗")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.6444em"}}),i("span",{staticClass:"mord"},[t._v("6")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),i("span",{staticClass:"mbin"},[t._v("∗")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.6444em"}}),i("span",{staticClass:"mord"},[t._v("3")])])])]),t._v("的RGB有3和通道，那么滤波器的也要有3个通道，即3个"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mn",[t._v("3")]),i("mo",[t._v("∗")]),i("mn",[t._v("3")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("3*3")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.6444em"}}),i("span",{staticClass:"mord"},[t._v("3")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),i("span",{staticClass:"mbin"},[t._v("∗")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.6444em"}}),i("span",{staticClass:"mord"},[t._v("3")])])])]),t._v("的矩阵组成一个filter。")]),t._v(" "),i("li",[i("strong",[t._v("某一层feature map的通道数=当前层滤波器的个数")]),t._v("，如上图只有一个filter，输出feature map为"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mn",[t._v("4")]),i("mo",[t._v("∗")]),i("mn",[t._v("4")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("4*4")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.6444em"}}),i("span",{staticClass:"mord"},[t._v("4")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),i("span",{staticClass:"mbin"},[t._v("∗")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.6444em"}}),i("span",{staticClass:"mord"},[t._v("4")])])])]),t._v("，只有1个通道；当有2个filter的时候，输出feature map应该是"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mn",[t._v("4")]),i("mo",[t._v("∗")]),i("mn",[t._v("4")]),i("mo",[t._v("∗")]),i("mn",[t._v("2")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("4*4*2")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.6444em"}}),i("span",{staticClass:"mord"},[t._v("4")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),i("span",{staticClass:"mbin"},[t._v("∗")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.6444em"}}),i("span",{staticClass:"mord"},[t._v("4")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),i("span",{staticClass:"mbin"},[t._v("∗")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.6444em"}}),i("span",{staticClass:"mord"},[t._v("2")])])])]),t._v("，通道数为2。")])]),t._v(" "),i("div",{staticClass:"custom-block tip"},[i("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),i("p",[t._v("CNN中的“filter”是“卷积核”的一个集合，在只有一个通道下，卷积核相当于filter，当有多个通道时，filter就包括多个通道里面的卷积核。")]),t._v(" "),i("p",[t._v("真实情况中，卷积核不需要人工设置，而是通过机器学习方法（反向传播，梯度下降方法）学习得到的。")]),t._v(" "),i("p",[t._v("卷积核权重初始值设定，在Keras中为例："),i("code",[t._v("kernel_initializer = 'glorot_uniform'")])])]),t._v(" "),i("h2",{attrs:{id:"池化层"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#池化层"}},[t._v("#")]),t._v(" 池化层")]),t._v(" "),i("center",[i("img",{attrs:{src:a(509),width:"60%"}})]),t._v(" "),i("p",[t._v("原始图片是20×20的，对其进行下采样，采样窗口是10×10，最终将其下采样成为一个2×2的特征图。这样大大减少运算量，还可以有效的避免过拟合。")]),t._v(" "),i("center",[i("img",{attrs:{src:a(510),width:"50%"}})]),t._v(" "),i("ul",[i("li",[t._v("最大池化（Max Pooling）：取区域的最大值。用的最多，")]),t._v(" "),i("li",[t._v("平均池化（Average Pooling）：取区域的平均值")])]),t._v(" "),i("div",{staticClass:"custom-block tip"},[i("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),i("p",[t._v("使用max pooling，舍弃其他值，是否会造成信息损失问题：")]),t._v(" "),i("ol",[i("li",[i("p",[t._v("CNN中每一个卷积核可以看做一个特征提取器，不同的卷积核负责提取不同的特征，对其进行Max Pooling操作后，提取出的是真正能够识别特征的数值，其余被舍弃的数值，对于所要提取特定的特征并没有特别大的帮助。那么在进行后续计算使，减小了feature map的尺寸，从而减少参数，达到减小计算量。")])]),t._v(" "),i("li",[i("p",[t._v("并不是所有情况Max Pooling的效果都很好，有时候有些周边信息也会对某个特定特征的识别产生一定效果，那么这个时候舍弃这部分“不重要”的信息，就不划算了。具体情况具体分析，可以进行一个加与不加的结果输出对比，看最大池化是否有反效果。")])])])]),t._v(" "),i("p",[i("strong",[t._v("池化的作用")]),t._v("：")]),t._v(" "),i("ol",[i("li",[t._v("减少参数量，还保留原始数据特征")]),t._v(" "),i("li",[t._v("防止过拟合")]),t._v(" "),i("li",[t._v("为卷积网络带来平移不变性")])]),t._v(" "),i("p",[t._v("在线手写数字识别卷积神经网络可视化网站：https://blog.csdn.net/Forrest97/article/details/105632656")]),t._v(" "),i("center",[i("img",{attrs:{src:a(511),width:"90%"}})]),t._v(" "),i("div",{staticClass:"custom-block tip"},[i("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),i("p",[t._v("1、手写字体图片转换成像素矩阵")]),t._v(" "),i("p",[t._v("2、对像素矩阵进行第一层卷积计算，生成六个feature map")]),t._v(" "),i("p",[t._v("3、对每个feature map进行下采样（downsampling），也叫池化（pooling），在保留feature map特征的同时缩小数据量。生成6个小图，这6个小图和上一层各自的feature map很像，但尺寸缩小了")]),t._v(" "),i("p",[t._v("4、对6个小图进行第二层卷积运算，生成更多的feature map")]),t._v(" "),i("p",[t._v("5、对第二次卷积生成的feature map进行下采样")]),t._v(" "),i("p",[t._v("6、第一层全连接层")]),t._v(" "),i("p",[t._v("7、第二层全连接层")]),t._v(" "),i("p",[t._v("8、连接softmax，输出分类结果")])]),t._v(" "),i("h2",{attrs:{id:"全连接层"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#全连接层"}},[t._v("#")]),t._v(" 全连接层")]),t._v(" "),i("p",[t._v("全连接层：输出的每一个神经元都和上一层的每一个神经元连接。")]),t._v(" "),i("center",[i("img",{attrs:{src:a(512),width:"20%"}})]),t._v(" "),i("div",{staticClass:"custom-block tip"},[i("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),i("p",[t._v("卷积核(filter)数量、大小、移动步长（stride）、补0圈数（padding）、全连接层和隐含层层数、神经元个数 都是超参数（hyperparameters），超参数是由人为根据经验指定的。")]),t._v(" "),i("p",[t._v("网络内部权重参数等是由训练得到。")])]),t._v(" "),i("p",[t._v("通过不断的设计卷积核的尺寸，数量，提取更多的特征，最后识别不同类别的物体。做完Max Pooling后，我们就会把这些数据“拍平”，丢到Flatten层，然后把Flatten层的output放到full connected Layer里，采用softmax对其进行分类。")]),t._v(" "),i("center",[i("img",{attrs:{src:a(513),width:"80%"}})]),t._v(" "),i("p",[t._v("手写数字可视化识别第一层全连接层：")]),t._v(" "),i("center",[i("img",{attrs:{src:a(514),width:"80%"}})]),t._v(" "),i("p",[t._v("第二层全连接层：")]),t._v(" "),i("center",[i("img",{attrs:{src:a(515),width:"80%"}})]),t._v(" "),i("p",[t._v("输出结果：")]),t._v(" "),i("center",[i("img",{attrs:{src:a(516),width:"80%"}})]),t._v(" "),i("h2",{attrs:{id:"模型训练过程"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#模型训练过程"}},[t._v("#")]),t._v(" 模型训练过程")]),t._v(" "),i("p",[t._v("损失函数：")]),t._v(" "),i("p",[t._v("​\t\t计算神经网络的预测结果与图片真实标签的差距，构造损失函数，训练的目标就是将找到损失函数的最小值，最后通过softmax给出预测分类的归一化概率分布决策。")]),t._v(" "),i("h2",{attrs:{id:"梯度下降"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#梯度下降"}},[t._v("#")]),t._v(" 梯度下降")]),t._v(" "),i("center",[i("img",{attrs:{src:a(517),width:"70%"}})]),t._v(" "),i("p",[t._v("要求得当"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("w")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("w")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.4306em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.02691em"}},[t._v("w")])])])]),t._v("为何值时，"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("J")]),i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mi",[t._v("w")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("J(w)")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")]),i("span",{staticClass:"mopen"},[t._v("(")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.02691em"}},[t._v("w")]),i("span",{staticClass:"mclose"},[t._v(")")])])])]),t._v("能够取得最小值。初始位置的切线的斜率为"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("a")]),i("mo",[t._v(">")]),i("mn",[t._v("0")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("a>0")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.5782em","vertical-align":"-0.0391em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("a")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),i("span",{staticClass:"mrel"},[t._v(">")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.6444em"}}),i("span",{staticClass:"mord"},[t._v("0")])])])]),t._v("（即该点导数大于0），"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("w")]),i("mo",[t._v("=")]),i("mi",[t._v("w")]),i("mo",[t._v("−")]),i("mi",[t._v("a")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("w=w-a")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.4306em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.02691em"}},[t._v("w")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.6667em","vertical-align":"-0.0833em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.02691em"}},[t._v("w")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}}),i("span",{staticClass:"mbin"},[t._v("−")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.4306em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("a")])])])]),t._v("能使得让"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("w")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("w")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.4306em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.02691em"}},[t._v("w")])])])]),t._v("的值减小，循环求导更新"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("w")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("w")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.4306em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.02691em"}},[t._v("w")])])])]),t._v("直到"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("J")]),i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mi",[t._v("w")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("J(w)")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")]),i("span",{staticClass:"mopen"},[t._v("(")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.02691em"}},[t._v("w")]),i("span",{staticClass:"mclose"},[t._v(")")])])])]),t._v("取得最小值。如果函数"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("J")]),i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mi",[t._v("w")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("J(w)")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")]),i("span",{staticClass:"mopen"},[t._v("(")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.02691em"}},[t._v("w")]),i("span",{staticClass:"mclose"},[t._v(")")])])])]),t._v("包含多个变量，需要分别对不同的变量求"),i("strong",[t._v("偏导")]),t._v("（partial derivative）来更新不同变量的值。")]),t._v(" "),i("h2",{attrs:{id:"参考资料"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[t._v("#")]),t._v(" 参考资料")]),t._v(" "),i("p",[t._v("1、一位大佬的关于CNN的博客，并用keras做了手写数字识别：")]),t._v(" "),i("p",[t._v("https://towardsdatascience.com/light-on-math-machine-learning-intuitive-guide-to-convolution-neural-networks-e3f054dd5daa")]),t._v(" "),i("p",[t._v("2、同济子豪兄在B站关于CNN的解读：")]),t._v(" "),i("p",[t._v("https://www.bilibili.com/video/BV1AJ411Q72b?p=6&spm_id_from=pageDriver")]),t._v(" "),i("p",[t._v("3、神经网络可视化网站的整理：")]),t._v(" "),i("p",[t._v("https://blog.csdn.net/Forrest97/article/details/105632656")]),t._v(" "),i("p",[t._v("4、一文看懂卷积神经网络，（该网页还包括其它ML算法的解读）：")]),t._v(" "),i("p",[t._v("https://easyai.tech/ai-definition/cnn/")]),t._v(" "),i("p",[t._v("5、大白话讲解CNN工作原理：")]),t._v(" "),i("p",[t._v("https://zhuanlan.zhihu.com/p/49184702")])],1)}),[],!1,null,null,null);s.default=e.exports}}]);